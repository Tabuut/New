<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåü Elite Player Rankings & Team Builder</title>
  <style>
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background-color: #1e1e2f; 
      color: #f0f0f0; 
      padding: 20px;
      margin: 0;
      direction: rtl; /* Ensure RTL layout */
    }
    h2 { 
      color: #ffd700; 
      font-size: 28px; 
      border-bottom: 2px solid #ffd700; 
      padding-bottom: 5px;
      text-align: center;
      margin-top: 40px;
    }
    h3 { 
      color: #00ffff; 
      margin-top: 30px; 
      font-size: 22px; 
      border-right: 5px solid #00ffff; /* RTL adjustment */
      padding-right: 10px;
      padding-left: 0;
      text-align: right;
    }
    ul { 
      list-style: none; 
      padding-right: 0; /* RTL adjustment */
    }
    li { 
      background: #2e2e3e; 
      margin: 6px 0; 
      padding: 10px 15px; 
      border-radius: 8px; 
      box-shadow: 0 0 5px #000;
      transition: transform 0.2s;
      text-align: right;
    }
    li:hover {
      transform: translateX(-5px); /* RTL adjustment */
      background: #3e3e4e;
    }
    li::before { 
      font-weight: bold;
      margin-left: 8px; /* RTL adjustment */
      margin-right: 0;
    }

    /* --- Player Level Icons --- */
    .level-container li::before { content: "‚≠ê"; }
    .level30 li::before { content: "üî•"; }
    .level29 li::before { content: "‚öîÔ∏è"; }
    .level28 li::before { content: "üõ°Ô∏è"; }
    .level27 li::before { content: "üè∞"; }
    .level26 li::before { content: "üß±"; }
    
    /* Teams Styling */
    .teams-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .team {
      background: linear-gradient(135deg, #2e2e3e 0%, #1e1e2e 100%);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      border: 2px solid;
    }
    .team h4 {
      margin: 0 0 15px 0;
      font-size: 20px;
      text-align: center;
      padding: 10px;
      border-radius: 8px;
    }
    .team li {
      background: #3e3e4e;
      font-size: 13px;
      padding: 6px 10px;
      margin: 4px 0;
      border-right: 4px solid #ffd700; /* Team list style */
      border-left: none;
    }
    .team li::before {
      content: "‚≠ê";
      margin-left: 5px;
    }
    .team-total {
      text-align: center;
      margin-top: 15px;
      padding: 10px;
      background: #1e1e2e;
      border-radius: 8px;
      font-weight: bold;
      font-size: 16px;
      color: #ffd700;
      border: 1px solid #555;
    }
    
    /* Hero Section Styles (Static Explanation) */
    .hero-section {
      background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%);
      border-radius: 15px;
      padding: 25px;
      margin: 30px 0;
      border: 2px solid #ffd700;
    }
    .hero-formations {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .hero-card {
      background: linear-gradient(135deg, #3a3a4e 0%, #2a2a3e 100%);
      border-radius: 12px;
      padding: 20px;
      border: 2px solid;
      transition: transform 0.3s;
    }
    .hero-card:hover {
      transform: translateY(-5px);
    }
    .hero-list {
      list-style: none;
      padding: 0;
      margin: 15px 0;
    }
    
    /* --- HERO GUIDE RTL FIXES APPLIED HERE --- */
    .hero-list li {
      background: #2e2e3e;
      margin: 8px 0;
      padding: 10px 15px;
      border-radius: 8px;
      border-right: 4px solid; /* FIXED: Use border-right for RTL accent */
      border-left: none; /* Ensure no border on left */
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .hero-card.garrison .hero-list li { border-right-color: #4ecdc4; } /* FIXED */
    .hero-card.attack .hero-list li { border-right-color: #ff6b6b; } /* FIXED */
    .hero-card.special .hero-list li { border-right-color: #ffd700; } /* FIXED */
    
    .hero-img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      border: 2px solid #ffd700;
      object-fit: cover;
      flex-shrink: 0;
    }
    .hero-note {
      background: #1e1e2e;
      padding: 12px;
      border-radius: 8px;
      margin-top: 15px;
      font-size: 13px;
      color: #a8a8b8;
      border-right: 3px solid #ffd700; /* RTL adjustment */
      border-left: none;
      line-height: 1.6;
    }
    .math-formula {
      background: #1a1a2a;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: #4ecdc4;
      margin: 15px 0;
      border: 1px solid #4ecdc4;
    }
    .info-box {
      background: #2a2a3e;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-right: 4px solid #ffd700; /* RTL adjustment */
      border-left: none;
    }
    
    /* Toggle & Visibility */
    .scenario-toggle { text-align: center; margin: 30px 0; background: #2a2a3e; padding: 15px; border-radius: 15px; border: 1px solid #444; }
    .scenario-toggle button { background: #444; color: #ccc; border: none; padding: 12px 30px; margin: 0 10px; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s; }
    .scenario-toggle button.active { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; box-shadow: 0 0 15px rgba(245, 87, 108, 0.5); }
    .scenario { display: none; animation: fadeIn 0.5s ease-in-out; }
    .scenario.active { display: block; }
    
    /* Helper classes for dynamic background/color */
    .color-ff6b6b { background: #ff6b6b; color: #fff; }
    .color-4ecdc4 { background: #4ecdc4; color: #fff; }
    .color-ffe66d { background: #ffe66d; color: #1e1e2f; }
    .color-a8e6cf { background: #a8e6cf; color: #1e1e2f; }
    .color-c7ceea { background: #c7ceea; color: #1e1e2f; }
  </style>
</head>
<body>

<h2>üß† Elite Player Rankings ‚Äì Sorted by Level & Power</h2>

<div id="playerRankingsContainer" style="height: 300px; overflow-y: scroll; background: #1a1a20; padding: 15px; border-radius: 10px; border: 1px solid #444; margin-bottom: 30px;">
  <p style="text-align: center; color: #888; font-size: 12px;">(Scroll to see full list)</p>
  <div id="L30-list"></div>
  <div id="L29-list"></div>
  <div id="L28-list"></div>
  <div id="L27-list"></div>
  <div id="L26-list"></div>
</div>


<h2>ü¶∏ Season 2 Hero Guide: Attack & Garrison Formations</h2>
<div class="hero-section">
  <h3 style="text-align: center; color: #ffd700; margin-top: 0;">‚öîÔ∏è Understanding Joiner Hero Mechanics</h3>
  
  <div class="info-box">
    <h5>üìñ How Joiner Heroes Work</h5>
    <p>When you join a rally or garrison, only your <strong>FIRST SLOT hero</strong> counts as the "joiner hero". Up to 4 joiner heroes can contribute their skills to boost the rally/garrison. The key is understanding how their buffs stack!</p>
  </div>

  <div class="math-formula">
    <strong>SkillMod Formula:</strong><br>
    SkillMod = (DamageUp √ó OppDefenseDown) / (OppDamageDown √ó DefenseUp)
  </div>

  <div class="hero-formations">
    
    <div class="hero-card garrison">
      <h4>üõ°Ô∏è Optimal Garrison Joiners</h4>
      <ul class="hero-list">
        <li>
          <img src="https://i.imghippo.com/files/kA4320nVQ.webp" alt="Gordon" class="hero-img">
          <span><strong>2√ó Gordon</strong> (DefenseUp +25% each)</span>
        </li>
        <li>
          <img src="https://i.imghippo.com/files/EApn2051oyY.webp" alt="Fahd" class="hero-img">
          <span><strong>1√ó Fahd</strong> (OppDamageDown +20%)</span>
        </li>
        <li>
          <img src="https://i.imghippo.com/files/naRe7519o.webp" alt="Howard" class="hero-img">
          <span><strong>1√ó Howard</strong> (DefenseUp +20%)</span>
        </li>
      </ul>
      <div class="hero-note">
        <strong>Why this works:</strong> This combination gives you 1.8√ó DefenseUp AND 1.2√ó OppDamageDown. Gordon (ID:113) and Howard (ID:111) stack multiplicatively!
      </div>
    </div>

    <div class="hero-card attack">
      <h4>‚öîÔ∏è Optimal Attack Joiners</h4>
      <ul class="hero-list">
        <li>
          <img src="https://i.imghippo.com/files/IS2459KVc.webp" alt="Chenko" class="hero-img">
          <span><strong>2√ó Chenko</strong> (DamageUp +25% each, ID:101)</span>
        </li>
        <li>
          <img src="https://i.imghippo.com/files/CaXt8360Hos.webp" alt="Amane" class="hero-img">
          <span><strong>2√ó Amane</strong> (DamageUp +25% each, ID:102)</span>
        </li>
      </ul>
      <div class="hero-note">
        <strong>Why mix them?</strong> Chenko and Amane have DIFFERENT identifiers (101 vs 102), so they multiply for 2.25√ó total damage!
      </div>
    </div>

    <div class="hero-card special">
      <h4>üìä Hero Effect Identifiers</h4>
      <div style="padding: 10px; font-size: 14px; line-height: 1.8;">
        <strong style="color: #ff6b6b;">‚öîÔ∏è DamageUp (Attack):</strong><br>
        ‚Ä¢ Chenko, Amadeus, Yeonwoo: <span style="color: #4ecdc4;">ID 101</span><br>
        ‚Ä¢ Amane, Margot, Hilde: <span style="color: #4ecdc4;">ID 102</span><br>
        <br>
        <strong style="color: #4ecdc4;">üõ°Ô∏è DefenseUp:</strong><br>
        ‚Ä¢ Howard, Quinn: <span style="color: #4ecdc4;">ID 111</span><br>
        ‚Ä¢ Saul, Hilde: <span style="color: #4ecdc4;">ID 112</span><br>
        ‚Ä¢ Gordon, Saul: <span style="color: #4ecdc4;">ID 113</span><br>
      </div>
    </div>
  </div>
</div>

<h2>‚öîÔ∏è Balanced Team Formations</h2>

<div class="scenario-toggle">
  <button onclick="toggleScenario('with_irish')" class="active" id="btn_with_irish">üî• With Irish Rogue</button>
  <button onclick="toggleScenario('without_irish')" id="btn_without_irish">‚ö° Without Irish Rogue</button>
</div>

<div id="with_irish" class="scenario active">
  <h3 id="with_irish_title" style="text-align: center; color: #ffd700;"></h3>
  <div id="teamsContainerWith" class="teams-container">
    </div>
</div>

<div id="without_irish" class="scenario">
  <h3 id="without_irish_title" style="text-align: center; color: #ffd700;"></h3>
  <div id="teamsContainerWithout" class="teams-container">
    </div>
</div>


<script>
  // Helper function to parse power (e.g., "213.2M" -> 213200000)
  function parsePower(powerStr) {
    if (typeof powerStr !== 'string') return 0;
    const value = parseFloat(powerStr.replace('M', '').replace(',', ''));
    return isNaN(value) ? 0 : value * 1000000;
  }

  // Function to format the total power
  function formatPower(power) {
    const powerInMillions = power / 1000000;
    return powerInMillions.toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g, ",") + 'M';
  }

  // Function to dynamically generate the Player Rankings list
  function renderPlayerLists(playersData) {
    const levelIcons = {
      '30': "üî•", '29': "‚öîÔ∏è", '28': "üõ°Ô∏è", '27': "üè∞", '26': "üß±"
    };

    const sortedLevels = Object.keys(playersData).sort((a, b) => parseInt(b) - parseInt(a));

    sortedLevels.forEach(level => {
      let html = `<h3>${levelIcons[level]} Level ${level}</h3><ul class="level-container level${level}">`;
      
      playersData[level].forEach(player => {
        html += `<li>${player.name} ‚Äì ${player.power}</li>`;
      });
      
      html += `</ul>`;
      
      const targetElement = document.getElementById(`L${level}-list`);
      if (targetElement) {
          targetElement.innerHTML = html;
      }
    });
  }

  // Function to dynamically generate the Team Formations
  function renderTeams(scenarioData, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    
    // Set the scenario title
    const titleElement = document.getElementById(containerId.replace('teamsContainer', '') + '_title');
    if (titleElement) {
        titleElement.textContent = scenarioData.name;
    }

    let teamCounter = 1;
    scenarioData.teams.forEach(team => {
      let listItems = '';
      let totalPower = 0;

      team.players.forEach(player => {
        totalPower += parsePower(player.power);
        const leaderStyle = player.isLeader ? `style="color: #${team.color}; font-weight: bold;"` : '';
        listItems += `<li ${leaderStyle}>${player.name} ‚Äì ${player.power}</li>`;
      });

      const teamCard = `
        <div class="team" style="border-color: #${team.color};">
          <h4 class="color-${team.color}">${team.name}</h4>
          <ul>${listItems}</ul>
          <div class="team-total">üí™ Power: ~${formatPower(totalPower)}</div>
        </div>
      `;
      container.innerHTML += teamCard;
      teamCounter++;
    });
  }

  // Main function to load all data
  async function loadDataAndRender() {
    try {
      const response = await fetch('players_data.json');
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();

      renderPlayerLists(data.all_players_by_level);
      renderTeams(data.scenarios.with_irish, 'teamsContainerWith');
      renderTeams(data.scenarios.without_irish, 'teamsContainerWithout');

      toggleScenario('with_irish');

    } catch (error) {
      console.error('CRITICAL ERROR loading data:', error);
      const errorHTML = '<p style="color:#ff6b6b; text-align:center; font-size:16px;">‚ö†Ô∏è ÿÆÿ∑ÿ£ ŸÅÿßÿØÿ≠ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÖŸÑŸÅ players_data.json ŸÅŸä ŸÜŸÅÿ≥ ÿßŸÑŸÖÿ¨ŸÑÿØ.</p>';
      document.getElementById('playerRankingsContainer').innerHTML = errorHTML;
      document.getElementById('teamsContainerWith').innerHTML = errorHTML;
      document.getElementById('teamsContainerWithout').innerHTML = '';
    }
  }

  // Function for the toggle buttons
  function toggleScenario(scenarioId) {
    document.getElementById('with_irish').classList.remove('active');
    document.getElementById('without_irish').classList.remove('active');
    
    document.getElementById('btn_with_irish').classList.remove('active');
    document.getElementById('btn_without_irish').classList.remove('active');
    
    const scenarioElement = document.getElementById(scenarioId);
    if(scenarioElement) {
        scenarioElement.classList.add('active');
    }
    
    const buttonElement = document.getElementById(`btn_${scenarioId}`);
    if(buttonElement) {
        buttonElement.classList.add('active');
    }
  }

  window.onload = loadDataAndRender;

</script>
</body>
</html>
